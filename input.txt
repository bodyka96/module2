I stolened this code in Github and optimized